spring.application.name=gateway-api

# üéØ GATEWAY - PRODUCTION  
server.port=8766  # ‚ö† Port diff√©rent de 8765

# ‚è± TIMEOUTS - PRODUCTION (plus courts)
spring.cloud.gateway.httpclient.connect-timeout=1000
spring.cloud.gateway.httpclient.response-timeout=3s

logging.level.org.springframework.cloud.gateway=INFO

eureka.client.service-url.defaultZone=http://localhost:8761/eureka
eureka.client.register-with-eureka=true
eureka.client.fetch-registry=true
eureka.instance.prefer-ip-address=true

# product-composite-service configuration
spring.cloud.gateway.routes[0].id=product_composite_route
spring.cloud.gateway.routes[0].uri=lb://product-composite-service
spring.cloud.gateway.routes[0].predicates[0]=Path=/api/product-composite/**

# product-service configuration
spring.cloud.gateway.routes[1].id=product_route
spring.cloud.gateway.routes[1].uri=lb://product-service
spring.cloud.gateway.routes[1].predicates[0]=Path=/api/products/**

# review-service configuration
spring.cloud.gateway.routes[2].id=review_route
spring.cloud.gateway.routes[2].uri=lb://review-service
spring.cloud.gateway.routes[2].predicates[0]=Path=/api/reviews/**

# recommendation-service configuration
spring.cloud.gateway.routes[3].id=recommendation_route
spring.cloud.gateway.routes[3].uri=lb://recommendation-service
spring.cloud.gateway.routes[3].predicates[0]=Path=/api/recommendations/**

# Tracing configuration
management.tracing.enabled=true
management.tracing.sampling.probability=1.0
management.tracing.exporter.zipkin.endpoint=http://localhost:9411/api/v2/spans

# Authorization Service configuration
spring.cloud.gateway.routes[4].id=auth_service_route
spring.cloud.gateway.routes[4].uri=http://localhost:9001
spring.cloud.gateway.routes[4].predicates[0]=Path=/auth/**

# Global filter configuration for authentication
# Activer le filtrage global pour l'authentification
spring.cloud.gateway.default-filters[0]=AddRequestHeader=gateway-request, true

# Logging pour le debugging des filtres
logging.level.com.example.gateway_api.filter=DEBUG
logging.level.org.springframework.cloud.gateway=DEBUG

# Configuration pour WebClient timeout (important pour l'appel auth)
spring.cloud.gateway.httpclient.connect-timeout=1000
spring.cloud.gateway.httpclient.response-timeout=5000
